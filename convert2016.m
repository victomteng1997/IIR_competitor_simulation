% here we put the example 3 first
%
%this is the 0.4-0.6 group

b = [0.002756027585718,-0.010638465461159,0.013522395470049,-0.001257149235437,-0.006334229814900, -0.023257930660897,0.035724631108545, 0.119201243999356,0.159391267484860, 0.109942260184545,0.041738623594693];
a1 = [0.013187357772492, 0.960400000000000;-0.134356649555223, 0.434847336191813;-0.727134812259496, 0.211314109409606;-0.391664414807565, 0.284274769973012;-0.744840340854602, 0.142717527142189];
%}

%{
this is the 0.525-1, 0-0.475 group

b = [0.007415270555549, 0.041695364650461,0.118260466750509, 0.235064039494851,0.361843765810713, 0.467794386328867,0.518109988503774, 0.506898188608209,0.437641941985079, 0.368438663410975,0.333026223927536, 0.154556998262422,0.255760527042458, 0.018932818149411,0.094510287842949];
a1 = [0.012411250062713, 0.960400000000000;0.012561632079084, 0.960400000000000;1.028880218050746, 0.314184366607445;0.328816485598726, 0.500342428276462;0.795149864011384, 0.407683731618903;0.067483266487796, 0.609278380358274;0.985509543263755, 0.271782523205804];
%}
%{
%this is the 0-0.4 0.56-1 group
b= [0.002748728986518, -0.012101157767721,0.013570033499413, -0.004875420711167,0.005861886578377, -0.023043069392442,0.006851154528334, 0.040218767938761,0.093725426821378, 0.068611156318233,0.047069428557195];
a1 = [-0.258091757913324, 0.499454478417403;-0.855327403592557, 0.259563050360766;-0.532511685694682, 0.376245336786124;-0.933099360994917, 0.241401369049653;-0.110158304970195, 0.960400000000000];
%}

%{
%this is the 0.6-1, 0-0.4 group

b =[-0.000326705270764, 0.000348713192628,0.002833151354080, 0.004168639318053,0.002031890927739, 0.001281385113626,0.004987584822602, 0.004626977136169,-0.003999949321071, -0.004299149478818,0.008073957254500, 0.000438481204852,-0.021898737390025, 0.020863583384301,-0.013996749100611];
a1 = [0.853215756657703, 0.422467038578290;
0.062649767825277, 0.915523452557548;
0.244040224553511, 0.595761135860849;
1.175619679371878, 0.417506927744546;
1.056669244261854, 0.266361417421870;
0.655570965359142, 0.298290136789618;
0.440901238408350, 0.505938652552057;];
%}

%{
%this is the band-pass filter 0.3- 0.5, cut at 0.6, 1
b = [0.000952027099020, -0.005952246831187,0.009768442705516, -0.002096869746550,-0.025737269818605, 0.063481677941090,-0.082538481811150, 0.072212688522776,-0.052123526953691, 0.047905245354360,-0.054115040302453, 0.034131130131442,0.016787331602758, -0.038388600674067,0.018104816638995]
a1 = [0.217216767563581, 0.748380606503396;-0.338069900954747, 0.567728324098532;-0.497163932668026, 0.568197942229535;-0.866522707023361, 0.627840595495722;-1.396830038682132, 0.947888999944218;0.009093946342486, 0.647659522889610;-1.081218704289346, 0.703652542302587;]

%}

%{
%this is the low_pass 0-0.5, 0.6/1
b = [0.009714076947310, -0.025597521467264,0.038050170266069, -0.033188023279187,0.031350945550652, -0.054299343975970,0.088449735763497, 0.234446594458478,0.474960380882249, 0.533438341040082,0.446592020536980, 0.230327226159773,0.081380156737016];
a1 = [0.208946272806038, 0.960400000000000;
-0.729576801386388, 0.237127399736224;
-0.601496365254957, 0.062509753088495;
0.155496467593502, 0.452989633876524;
0.321416461388558, 0.942235514737220;
-0.199764273005623, 0.319125676475747];
%}
syms z;
dim = size(a1);
sum = [1];

for i = 1:dim(1)
    sum = conv(sum,[a1(i,2),a1(i,1),1]);
end

a = fliplr(sum);
bk = truncate(b,14);
ak = truncate(a,14);

bk-b
ak-a
[h,w] = freqz(bk,ak,300);

plot(w/pi,20*log10(abs(h)))
xlabel('Normalized Frequency (\times\pi rad/sample)')
ylabel('Magnitude (dB)')
figure(2)
[gd,w]=grpdelay(bk,ak,500);
plot(w(1:200),gd(1:200))
max(gd(1:200))-min(gd(1:200))